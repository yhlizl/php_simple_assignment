========================================
  🚨 重要安全警告
========================================

⚠️ 你的 OpenAI API Key 已經暴露！

========================================

❌ 發生了什麼事？
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

你的 OpenAI API Key 被包含在 Git 提交中，
並且差點被推送到 GitHub 公開儲存庫。

GitHub 的安全掃描機制偵測到並阻止了推送。

暴露的 API Key：
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

========================================

⚠️ 風險
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

如果 API Key 被公開：
❌ 任何人都可以使用你的 API Key
❌ 可能產生大量費用
❌ 你的 OpenAI 帳號可能被濫用
❌ 可能違反 OpenAI 使用條款

========================================

✅ 立即行動（必須做）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

步驟 1：刪除舊的 API Key
────────────────────────────────────

1. 前往：https://platform.openai.com/api-keys
2. 登入你的 OpenAI 帳號
3. 找到這個 API Key（sk-proj-d5OcFz...）
4. 點擊「Delete」或「Revoke」刪除它
5. 確認刪除

⚠️ 這是最重要的步驟！必須立即執行！


步驟 2：建立新的 API Key
────────────────────────────────────

1. 在同一個頁面點擊「Create new secret key」
2. 給它一個名稱（例如：教育輔導工具）
3. 複製新的 API Key
4. 妥善保存（只會顯示一次）


步驟 3：在本地設定新的 API Key
────────────────────────────────────

方法一：使用環境變數（推薦）⭐

Windows:
1. 開啟命令提示字元
2. 輸入：
   setx OPENAI_API_KEY "你的新API Key"
3. 重新開啟命令提示字元
4. 啟動伺服器

Mac/Linux:
1. 編輯 ~/.bashrc 或 ~/.zshrc
2. 加入：
   export OPENAI_API_KEY="你的新API Key"
3. 執行：source ~/.bashrc
4. 啟動伺服器


方法二：直接在程式碼中設定（不推薦）

⚠️ 注意：這個方法不安全，只適合本地測試

1. 用記事本開啟 my_prompt.php
2. 找到第 29 行
3. 改成：
   $apiKey = getenv('OPENAI_API_KEY') ?: '你的新API Key';
4. 儲存檔案
5. ⚠️ 絕對不要提交到 Git！


========================================

✅ 已經為你做的事
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

✅ 1. 清理 Git 歷史記錄
   - 移除包含 API Key 的提交
   - 重置到安全的版本

✅ 2. 更新程式碼
   - my_prompt.php 改用環境變數
   - 不再硬編碼 API Key

✅ 3. 建立安全警告
   - 本檔案（🚨 API Key 安全警告.txt）


========================================

📋 檢查清單
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

請確認以下步驟都已完成：

□ 已登入 OpenAI 平台
□ 已刪除舊的 API Key（sk-proj-d5OcFz...）
□ 已建立新的 API Key
□ 已複製並保存新的 API Key
□ 已設定環境變數（或在程式碼中設定）
□ 已測試新的 API Key 是否能正常使用


========================================

🔒 未來如何避免
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. ✅ 永遠使用環境變數
   - 不要在程式碼中硬編碼 API Key
   - 使用 .env 檔案（並加入 .gitignore）

2. ✅ 檢查 .gitignore
   - 確保 .env 檔案不會被提交
   - 確保包含敏感資訊的檔案都被忽略

3. ✅ 提交前檢查
   - 使用 git diff 檢查變更
   - 確認沒有敏感資訊

4. ✅ 使用 Git Hooks
   - 設定 pre-commit hook 檢查敏感資訊
   - 自動阻止包含 API Key 的提交


========================================

❓ 常見問題
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Q1: 我的 API Key 已經被公開了嗎？
A: 沒有！GitHub 阻止了推送，所以沒有公開。
   但為了安全起見，還是建議刪除並建立新的。

Q2: 我需要付費嗎？
A: 如果 API Key 沒有被公開使用，就不會產生額外費用。
   刪除舊的 Key 後就安全了。

Q3: 如何檢查我的 API 使用量？
A: 前往：https://platform.openai.com/usage
   查看使用記錄和費用

Q4: 環境變數是什麼？
A: 環境變數是作業系統層級的設定，
   程式可以讀取但不會被包含在程式碼中，
   比直接寫在程式碼中安全得多。

Q5: 我可以繼續使用舊的 API Key 嗎？
A: 不建議！雖然沒有公開，但已經在 Git 歷史中，
   為了安全起見，請刪除並建立新的。


========================================

📚 相關資源
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

- OpenAI API Keys: https://platform.openai.com/api-keys
- OpenAI 使用量: https://platform.openai.com/usage
- OpenAI 安全最佳實踐: https://platform.openai.com/docs/guides/safety-best-practices


========================================

✅ 總結
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

問題：API Key 差點被推送到 GitHub
狀態：✅ 已阻止，沒有公開
行動：⚠️ 必須刪除舊 Key 並建立新 Key

下一步：
1. 刪除舊的 API Key（必須）
2. 建立新的 API Key
3. 使用環境變數設定
4. 測試功能

========================================

⚠️ 請立即執行步驟 1：刪除舊的 API Key！

========================================

